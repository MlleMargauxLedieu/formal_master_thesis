\documentclass{kththesis}

\usepackage{blindtext} % This is just to get some nonsense text in this template, can be safely removed

\usepackage{csquotes} % Recommended by biblatex
\usepackage{biblatex}
\usepackage{amsmath}
\usepackage{url}
\usepackage[bookmarks,pdftitle={thesis title}]{hyperref}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{multirow}
\usepackage{lipsum}
\usepackage[acronym]{glossaries}
\usepackage{titling}
\setcounter{biburllcpenalty}{7000}
\setcounter{biburlucpenalty}{8000}
\addbibresource{references.bib} % The file containing our references, in BibTeX format

\makenoidxglossaries
 
 
\newglossaryentry{epochs}
{
    name=epoch,
    description={An epoch is completed when the model has seen all the samples once}
} 
\newglossaryentry{over-fitting}
{
    name=over-fitting,
    description={A network is over-fitting when it becomes too specific to the training samples. If a network over-fits does not generalize well on new data}
} 
\newacronym{sgd}{SGD}{Stochastic Gradient Descent}
\newacronym{cnn}{CNN}{Convolutional Neural Network}
\newacronym{drt}{DRT}{Depositional Rock Types}
\newacronym{ps}{PS}{Packstone}
\newacronym{ms}{MS}{Mudstone}
\newacronym{gs}{GS}{Grainstone} 
\newacronym{psgs}{PS-GS}{Packstone - Grainstone}
\newacronym{ws}{WS}{Wackstone} 
\newacronym{svm}{SVM}{Support Vector Machines} 
\newacronym{rf}{RF}{Random Forest} 
\glsadd{sgd}\glsadd{cnn}\glsadd{drt}\glsadd{ws}\glsadd{gs}\glsadd{ps}\glsadd{psgs}


\title{Classifying reservoir rock quality from thin sections of core using Convolutional Neural Networks}
\alttitle{Klassificera reservoarrockkvalitet utifrån tunna kärnstensektioner med hjälp av Convolutional Neural Networks}
\author{Margaux Ledieu}
\email{lmledieu@kth.se}
\supervisor{Haibo Li}
\examiner{Anders Hedman}
\programme{Master in Machine Learning}
\school{School of Electrical Engineering and Computer Science}
\date{\today}


\begin{document}
\selectlanguage{english}
% Frontmatter includes the titlepage, abstracts and table-of-contents
\frontmatter

\titlepage

\begin{abstract}
In the past few years, the use of Deep Learning in the petroleum industry has increased, especially for seismic interpretation and signal processing. However its use remains shy in image analysis and carbonates classification. This study aims at applying Deep Learning on reservoir rock images and produce an image classification algorithm. The images used are thin sections of core rocks gathered while drilling exploration wells. The purpose is to classify thin sections according to their level of porosity, their Dunham and \gls{drt} classification, and to be able to identify the different components they contain. These predictions will assist geologists in their labeling tasks. 

The algorithm is based on \gls{cnn}. We tested three different \gls{cnn} with different hyperparamters, optimizers as well as initialization strategies. We compared the results in order to find the best setting to achieve the task.
We found that the best performing network was Inception\_v3 with random initialization. The best optimizer to use depends on the class we predict on. Our best accuracy on the test set is 76,1\% to identify the level of porosity, 68,4\% to classify the images according to their Dunham classification and 53,7\% for the \gls{drt} classification. The network also manages to identify all the components in an image with a F1-score of 50,2\%. 
The main misclassifications are between rocks that are adjacent in the classification. This means that our algorithm struggles to differentiate similar rocks. When we compare our results to experienced geologists with carbonate classification experience, we observe that they make similar mistakes.

The results of this study show great potential for the use of Deep Learning in classification of core thin sections. 
\end{abstract}


\begin{otherlanguage}{swedish}
  \begin{abstract}
\section*{Klassificera reservoarrockkvalitet utifrån tunna kärnstensektioner med hjälp av Convolutional Neural Networks}

Under de senaste åren har användningen av Deep Learning inom petroleumindustrin ökat, speciellt för seismisk tolkning och signalbehandling. Men dess användning förblir minimalt inom bildanalys och karbonaterklassificering. Denna studie syftar på att använda  Deep Learning på reservoarrockbilder och utveckla en bildklassificeringsalgoritm. Bilder av tunna sektioner av kärnstenar som har samlats under borrningsutforskningsbrunnar används. Syftet är att klassificera tunna sektioner i enlighet med deras porositetsnivå, Dunham och \gls{drt} klassificering och identifiera de olika komponenterna de innehåller. 
Dessa förutsägelser kommer att hjälpa geologer i sina märkningsuppgifter. 

Algoritmen är baserad på \gls{cnn}. Tre olika \gls{cnn}  med olika hyperparametrar, optimerings- och initialiseringsstrategier testades. 
Resultaten jämfördes för att hitta den bästa inställningen för att uppfylla uppgiften. 

Det bästa nätverket vissade sig att vara Inception\_v3 med slumpmässig initialisering. Bästa optimeringsverktyget varierar beroende på vilken klass vi förutspår. Bästa noggrannhet på testuppsättningen är 76,1\% för identifiering av porositetsnivå, 68,4\% för klassificering av bilderna enligt deras Dunham-klassificering och 53,7\% enligt \gls{drt}-klassidicering. Nätverket kan också identifiera alla komponenter i en bild med ett F1-poäng av 50,2\%. 
De största felklassificeringarna är mellan stenar som ligger nära varandra i klassificeringen. Algoritmens felklassificeringar liknar dem som görs av erfarna geologer med karbonat klassificeringserfarenhet. 
Resultaten av denna studie visar stor potential för användningen av Deep Learning i klassificering tunna kärnstensektioner.

  \end{abstract}
\end{otherlanguage}

\pagenumbering{roman}                             % small roman letters as page numbers
\tableofcontents\newpage
\addcontentsline{toc}{chapter}{List of Figures}
\listoffigures\newpage
\addcontentsline{toc}{chapter}{List of Tables}
\listoftables\newpage
\addcontentsline{toc}{chapter}{Glossary}
\printnoidxglossary[type=\acronymtype]\newpage
\addcontentsline{toc}{chapter}{Acronyms}
\printnoidxglossary\newpage
\cleardoublepage
\pagenumbering{arabic}  


% Mainmatter is where the actual contents of the thesis goes
%\mainmatter

\include{chapters/01-introduction}
\include{chapters/02-background}
\include{chapters/03-methodology}
\include{chapters/04-results}
\include{chapters/06-discussion}
\include{chapters/07-conclusion}


\printbibliography[heading=bibintoc] % Print the bibliography (and make it appear in the table of contents)

\appendix


\end{document}
